--ZAPYTANIA SQL
--WYPISUJE INFORMACJE O OCHRONIE WSZYSTKICH RYB
SELECT NAZWA, R.IDOCHRONY, DLUGOSC_OCHRONNA, OKRES_OCHRONNY
FROM RYBA R, OCHRONA O
WHERE R.IDOCHRONY = O.IDOCHRONY;

--WYPISUJE NAJWIĘKSZE OKAZY SANDACZY ZŁAPANYCH PRZEZ UZYTKOWNIKOW
SELECT IMIE, NAZWISKO, NAZWA, DLUGOSC, WAGA
FROM UZYTKOWNIK U, RYBA R, REKORD RE
WHERE U.NICK = RE.NICK AND R.IDRYBY = RE.IDRYBY AND NAZWA = 'Sandacz';

--WYPISUJE W JAKICH LOWISKACH WYSTĘPUJE AMUR
SELECT NAZWA_LOWISKA
FROM LOWISKO L, RYBA R, WYSTEPUJE_W W
WHERE R.IDRYBY = W.IDRYBY AND L.IDLOWISKA = W.IDLOWISKA
AND R.NAZWA = 'Amur';

--WYPISUJE RYBY KTÓRE MOŻNA ZŁOWIĆ NA WOBLER
SELECT NAZWA
FROM RYBA R, PRZYNETA P, BIERZE_NA B
WHERE R.IDRYBY = B.IDRYBY AND P.IDPRZYNETY = B.IDPRZYNETY AND RODZAJ_PRZYNETY = 'Wobler';

--WYPISUJE RYBY KTÓRE MOŻNA ZŁOWIĆ W KOMERCYJNYCH LOWISKACH
SELECT DISTINCT NAZWA
FROM LOWISKO L, RYBA R, WYSTEPUJE_W W
WHERE R.IDRYBY = W.IDRYBY AND L.IDLOWISKA = W.IDLOWISKA
AND L.RODZAJ_LOWISKA = 'Komercyjne';

--WYPISUJE NAZWY RYBY KTÓRE WYSTĘPUJĄ W WIĘCEJ NIŻ 3 LOWISKACH
SELECT NAZWA, COUNT(*)
FROM RYBA R, LOWISKO L, WYSTEPUJE_W W
WHERE R.IDRYBY = W.IDRYBY AND L.IDLOWISKA = W.IDLOWISKA
GROUP BY NAZWA
HAVING COUNT(*) > 3;

--WYPISUJE LOWISKA ORAZ LICZBE WYSTEPUJACYCH RYB
SELECT NAZWA_LOWISKA, COUNT(*)
FROM RYBA R, LOWISKO L, WYSTEPUJE_W W
WHERE R.IDRYBY = W.IDRYBY AND L.IDLOWISKA = W.IDLOWISKA
GROUP BY NAZWA_LOWISKA;

--WYPISUJE PRZYNETY KTORYMI MOZNA ZLOWIC WIECEJ NIZ 5 RYB
SELECT RODZAJ_PRZYNETY, COUNT(*)
FROM RYBA R, PRZYNETA P, BIERZE_NA B
WHERE R.IDRYBY = B.IDRYBY AND P.IDPRZYNETY = B.IDPRZYNETY
GROUP BY RODZAJ_PRZYNETY
HAVING COUNT(*) > 5;

--WYPISUJE OKREGI W KTORYCH CENA ZA KARTE RYBACKA JEST WYZSZA NIZ SREDNIA CENA
SELECT NAZWA_OKREGU
FROM OKREGI_PZW
WHERE CENA > (SELECT AVG(CENA)
FROM OKREGI_PZW);

--WYPISUJE NAZWY I MAX DLUGOSC NAJWIEKSZYCH PRZEDSTAWICIELI DANEJ RODZINY RYB
SELECT NAZWA, MAX_DLUGOSC
FROM RYBA
WHERE (MAX_DLUGOSC, RODZINA_RYB) IN
(SELECT MAX(MAX_DLUGOSC), RODZINA_RYB
FROM RYBA
GROUP BY RODZINA_RYB);

WYPISUJE RODZINE RYB Z NAJWIEKSZA SREDNIA MAKSYMALNEJ DLUGOSCI
SELECT RODZINA_RYB, AVG(MAX_DLUGOSC)
FROM RYBA
GROUP BY RODZINA_RYB 
HAVING AVG(MAX_DLUGOSC) =
(SELECT MAX(AVG(MAX_DLUGOSC))
FROM RYBA
GROUP BY RODZINA_RYB);

SELECT IMIE, NAZWISKO
FROM UZYTKOWNIK U
WHERE EXISTS
(SELECT R.NICK
FROM REKORD R
WHERE U.NICK = R.NICK);